pipeline{
  agent any
    environment{
          SQLSERVER = 'JAYARAM\\DEVELOPER1'
          DATABASE = 'ErrorBD'
          login = 'JaiLogin'
          pwd = 'Jayaram@300'
     }

   stages{
      stage('Checkout code from github'){
      steps{
       checkout scm
      }
      }

    stage('Input the data into sql server'){
    steps{
    script{
    def bulkinsertquery = """
    BULK INSERT health.Population
    FROM 'D:\\SSISGitReport1\\Files\\filepopulation.csv'
    WITH (
    FIRSTROW = 2,
    FIELDTERMINATOR = ',',
    ROWTERMINATOR = '\n',
    TABLOCK
    );
    """
    def escaped_query = bulkinsertquery.replace('"','\\').replace('\n',' ').trim()
    echo 'Executing query ${bulkinsertquery}'
    bat """
    sqlcmd -S ${env.SQLSERVER} -d ${env.DATABASE} -U ${env.login} -P "${env.pwd}" -Q "${escaped_query}"
   """
    }
    }
    }
    }
}

    

