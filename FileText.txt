pipeline{
  agent any
    environment{
          SQLSERVER = 'JAYARAM\\DEVELOPER1'
          DATABASE = 'ErrorBD'
          login = 'JaiLogin'
          pwd = 'Jayaram@300'
     }

   stages{
      stage('Checkout code from github'){
      steps{
       checkout scm
      }
      }

    stage('Input the data into sql server'){
    steps{
    script{
    def bulkinsertquery = """
    BULK INSERT health.Population from 'D:\\SSISGitReport1\\Files\\filepopulation.csv'
    with(
    Firstrow = 2, 
    FieldTerminator = ',', 
    RowTerminator = '\\n',
    TABBLOCK);
    """
    def escaped_query = bulkinsertquery.replace(',','\\').replace('n','')
    echo 'Executing query ${bulkinsertquery}'
    bat """
    sqlcmd -S ${env.SQLSERVER} -d ${env.DATABASE} -U ${env.login} -P "${env.pwd}" -Q "${escaped_query}"
   """
    }
    }
    }
    }
}

    

